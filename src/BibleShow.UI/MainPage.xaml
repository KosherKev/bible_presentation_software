<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="BibleShow.UI.MainPage"
             Title="Live Control">

    <Grid RowDefinitions="Auto,*"
          ColumnDefinitions="*,2*"
          Padding="16"
          BackgroundColor="{AppThemeBinding Light={StaticResource Background}, Dark={StaticResource BackgroundDark}}">

        <!-- Search and Controls -->
        <Grid Grid.Row="0" Grid.ColumnSpan="2"
              ColumnDefinitions="*,Auto"
              Margin="0,0,0,16">
            <SearchBar Grid.Column="0"
                       x:Name="SearchBar"
                       Placeholder="Search Bible..."
                       TextChanged="OnSearchTextChanged"
                       BackgroundColor="{AppThemeBinding Light={StaticResource Surface}, Dark={StaticResource SurfaceDark}}"
                       TextColor="{AppThemeBinding Light={StaticResource Text}, Dark={StaticResource TextDark}}" />
            <Button Grid.Column="1"
                    Text="Present"
                    Style="{StaticResource PrimaryButton}"
                    Clicked="OnPresentClicked"
                    Margin="8,0,0,0" />
        </Grid>

        <!-- Bible Browser -->
        <CollectionView Grid.Row="1" Grid.Column="0"
                        x:Name="VersesCollection"
                        ItemsSource="{Binding Verses}"
                        SelectionMode="Single"
                        SelectionChanged="OnVerseSelected"
                        BackgroundColor="{AppThemeBinding Light={StaticResource Surface}, Dark={StaticResource SurfaceDark}}"
                        Margin="0,0,8,0">
            <CollectionView.Header>
                <Label Text="Bible Browser"
                       FontSize="20"
                       Margin="16,16,16,8"
                       TextColor="{AppThemeBinding Light={StaticResource Text}, Dark={StaticResource TextDark}}" />
            </CollectionView.Header>
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="16,8">
                        <VerticalStackLayout>
                            <Label Text="{Binding Reference}"
                                   FontSize="16"
                                   FontAttributes="Bold"
                                   TextColor="{AppThemeBinding Light={StaticResource Text}, Dark={StaticResource TextDark}}" />
                            <Label Text="{Binding Text}"
                                   FontSize="14"
                                   LineBreakMode="TailTruncation"
                                   MaxLines="2"
                                   TextColor="{AppThemeBinding Light={StaticResource TextSecondary}, Dark={StaticResource TextSecondaryDark}}" />
                        </VerticalStackLayout>
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- Preview and Controls -->
        <Grid Grid.Row="1" Grid.Column="1"
              RowDefinitions="*,Auto"
              BackgroundColor="{AppThemeBinding Light={StaticResource Surface}, Dark={StaticResource SurfaceDark}}">
            
            <!-- Preview -->
            <Frame Grid.Row="0"
                   Margin="16"
                   Padding="32"
                   BackgroundColor="{AppThemeBinding Light={StaticResource Background}, Dark={StaticResource BackgroundDark}}"
                   BorderColor="{AppThemeBinding Light={StaticResource Border}, Dark={StaticResource BorderDark}}">
                <Label Text="{Binding PreviewText}"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"
                       TextColor="{AppThemeBinding Light={StaticResource Text}, Dark={StaticResource TextDark}}"
                       FontSize="18"
                       LineBreakMode="WordWrap" />
            </Frame>

            <!-- Controls -->
            <Grid Grid.Row="1"
                  Padding="16"
                  ColumnDefinitions="Auto,*,Auto,Auto"
                  BackgroundColor="{AppThemeBinding Light={StaticResource Background}, Dark={StaticResource BackgroundDark}}">
                <Button Grid.Column="0"
                        Text="Previous"
                        Style="{StaticResource SecondaryButton}"
                        Clicked="OnPreviousClicked" />
                <Button Grid.Column="2"
                        Text="Clear"
                        Style="{StaticResource SecondaryButton}"
                        Clicked="OnClearClicked"
                        Margin="0,0,8,0" />
                <Button Grid.Column="3"
                        Text="Next"
                        Style="{StaticResource SecondaryButton}"
                        Clicked="OnNextClicked" />
            </Grid>
        </Grid>
    </Grid>

</ContentPage>
